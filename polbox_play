from selenium import webdriver
from selenium.webdriver.common.keys import Keys
import time
from selenium.webdriver.common.by import By
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.wait import WebDriverWait
from selenium.webdriver.common.action_chains import ActionChains

def wait_of_element(xpath, driver):
    element = WebDriverWait(driver, 15).until(
        EC.presence_of_element_located(
            (By.XPATH, xpath)
        )
    )
    return element

def test_adding_to_bookmarks():
    options = webdriver.ChromeOptions()
    prefs = {"profile.default_content_setting_values.notifications": 2}
    options.add_experimental_option("prefs", prefs)
    options.add_argument(f"--user-data-dir=C:/Users/ДанилаСан/AppData/Local/Google/Chrome/User Data")
    driver = webdriver.Chrome(options=options, executable_path=r'E:/selenium/chromedriver.exe')
    driver.get("http://play.polbox.tv/")
    
    print("\nОткрыта страница Succesful")
    choose_channel = wait_of_element(xpath='//*[@id="root"]//div[2]/div[1]/div[2]/div[1]', driver=driver) # Выбираем канал
    choose_channel.click()
    time.sleep(1)
    channel_name = wait_of_element(xpath='//*[@id="root"]/div/div/div/div[1]/div/div[1]/div/div/div', driver=driver) # Находим и запоминаем имя канала
    first_name = str(channel_name.text)
    print(first_name)
    choose_channel0 = wait_of_element(xpath='//*[@id="root"]/div/div/div/div[1]/div/div[2]/div[1]/video', driver=driver) # Ставим канал на паузу
    time.sleep(2)
    choose_channel0.click()
    print("пауза")
    channel_to_bookmarks = wait_of_element(xpath='//*[@id="root"]//div[2]/div[2]/button', driver=driver) # Жмем добавить в закладки
    channel_to_bookmarks.click()
    print("добавили в закладки")
    bookmarks_button = wait_of_element(xpath='//*[@id="root"]//header//button[4]', driver=driver)# Переход в закладки
    bookmarks_button.click()
    print("переход в закладки")
    time.sleep(1)
    bookmarks_channel = wait_of_element(xpath='//*[@id="root"]/div/div/div/div[1]/div/div[2]/button', driver=driver)# Переход в закладки каналов
    bookmarks_channel.click()
    print("переход в каналы в закладках")
    time.sleep(1)
    channel_in_bookmarks = wait_of_element(xpath='//*[@id="root"]//div[2]/div/div/div/div/div/div[1]/div', driver=driver) # Находим и проверяем имя канала в закладках
    second_name = str(channel_in_bookmarks.text)
    print(second_name)
    if first_name == second_name:
        print("Adding to bookmarks Succesful")
    else:
        print("Adding to bookmarks failed")

    wait = WebDriverWait(driver, 10)
    channel_remove = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[2]//div[1]/div/div[3]'))) # Наводим курсор на канал в закладках
    ActionChains(driver).move_to_element(channel_remove).perform()
    remove_button = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[6]/button')))# Жмем удалить канал из закладок
    ActionChains(driver).move_to_element(remove_button).click().perform()

    yes_button = wait_of_element(xpath='/html/body//div[3]/div//div/div[2]/button[1]', driver=driver)# Жмем да
    yes_button.click()
    print('Deleting from bookmarks Succesful')

if __name__ == '__main__':
    test_adding_to_bookmarks()


def test_adding_movies_to_bookmarks():
    options = webdriver.ChromeOptions()
    prefs = {"profile.default_content_setting_values.notifications": 2}
    options.add_experimental_option("prefs", prefs)
    options.add_argument(f"--user-data-dir=C:/Users/ДанилаСан/AppData/Local/Google/Chrome/User Data")
    driver = webdriver.Chrome(options=options, executable_path=r'E:/selenium/chromedriver.exe')
    driver.get("http://play.polbox.tv/#/movies")
    print("\nОткрыта страница Succesful")

    movie_name = wait_of_element(xpath='//*[@id="root"]//div[1]/div/div/div/h2', driver=driver) # Находим и запоминаем имя movie
    first_name = str(movie_name.text)
    print(first_name)
    choose_watch_1 = wait_of_element(xpath='//*[@id="root"]//div[1]/div/div/div/div[3]/button[1]', driver=driver) # Жмем смотреть 1 раз
    time.sleep(2)
    choose_watch_1.click()

    choose_watch_2 = wait_of_element(xpath='//*[@id="root"]//div[4]//button[1]', driver=driver) # Жмем смотреть 2 раз
    choose_watch_2.click()

    pause_watch = wait_of_element(xpath='//*[@id="root"]//div[1]/video', driver=driver) # Ставим на паузу
    pause_watch.click()

    movie_to_bookmarks = wait_of_element(xpath='//*[@id="root"]//div[2]/button[2]', driver=driver) # Жмем добавить в закладки
    movie_to_bookmarks.click()
    print("добавили в закладки")

    back_button = wait_of_element(xpath='//*[@id="root"]//div[2]/button[1]', driver=driver)# Жмем назад кнопку
    back_button.click()

    bookmarks_button = wait_of_element(xpath='//*[@id="root"]//header//button[4]', driver=driver)# Переход в закладки
    bookmarks_button.click()
    print("переход в закладки")
    time.sleep(1)

    movie_in_bookmarks = wait_of_element(xpath='//*[@id="root"]//div[3]/div[1]', driver=driver) # Находим и проверяем имя канала в закладках
    second_name = str(movie_in_bookmarks.text)
    print(second_name)
    if first_name == second_name:
        print("Adding movies to bookmarks Succesful")
    else:
        print("Adding movies to bookmarks FAILED!!!")

    wait = WebDriverWait(driver, 10)
    channel_remove = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div/div[3]'))) # Наводим курсор на кино в закладках
    ActionChains(driver).move_to_element(channel_remove).perform()
    remove_button = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[6]/button/span')))# Жмем удалить кино из закладок
    ActionChains(driver).move_to_element(remove_button).click().perform()

    yes_button = wait_of_element(xpath='/html/body//div[3]//div[2]/button[1]', driver=driver)# Жмем да
    yes_button.click()
    print('Deleting from bookmarks Succesful')

if __name__ == '__main__':
    test_adding_movies_to_bookmarks()


def test_adding_channel_to_favorites():
    options = webdriver.ChromeOptions()
    prefs = {"profile.default_content_setting_values.notifications": 2}
    options.add_experimental_option("prefs", prefs)
    options.add_argument(f"--user-data-dir=C:/Users/ДанилаСан/AppData/Local/Google/Chrome/User Data")
    driver = webdriver.Chrome(options=options, executable_path=r'E:/selenium/chromedriver.exe')
    driver.get("http://play.polbox.tv/")
    #driver.get("http://play.polbox.tv/#/bookmarks")

    print("\nОткрыта страница Succesful")
    wait = WebDriverWait(driver, 10)
    channel_remove = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]/div/div/div/div[2]/div[1]'))) # Наводим курсор на канал
    ActionChains(driver).move_to_element(channel_remove).perform()
    adding_button = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[1]/div[3]/button')))# Жмем добавить канал в избранное
    ActionChains(driver).move_to_element(remove_button).click().perform()
    channel_name = wait_of_element(xpath='//*[@id="root"]//div[2]/div[1]/div[2]/div[1]/div', driver=driver) # Находим и запоминаем имя канала
    first_name = str(channel_name.text)
    print(first_name)
    bookmarks_button = wait_of_element(xpath='//*[@id="root"]//header//button[3]', driver=driver)# Переход в закладки
    bookmarks_button.click()
    print("переход в закладки")
    time.sleep(1)
    bookmarks_channel = wait_of_element(xpath='//*[@id="root"]/div/div/div/div[1]/div[1]/div[2]/button', driver=driver)# Переход в закладки каналов
    bookmarks_channel.click()
    print("переход в каналы в закладках")
    time.sleep(1)
    channel_in_bookmarks = wait_of_element(xpath='//*[@id="root"]//div[2]/div/div/div/div/div[1]/div', driver=driver) # Находим и проверяем имя канала в закладках
    second_name = str(channel_in_bookmarks.text)
    print(second_name)
    if first_name == second_name:
        print("Adding to favorites Succesful")
    else:
        print("Adding to favorites failed")

    wait = WebDriverWait(driver, 10)
    channel_remove = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[2]/div/div/div/div/div[2]'))) # Наводим курсор на канал в закладках
    ActionChains(driver).move_to_element(channel_remove).perform()
    remove_button = wait.until(EC.visibility_of_element_located((By.XPATH, '//*[@id="root"]//div[6]/button')))# Жмем удалить канал из закладок
    ActionChains(driver).move_to_element(remove_button).click().perform()

    yes_button = wait_of_element(xpath='/html/body//div[3]//div[2]/button[1]', driver=driver)# Жмем да
    yes_button.click()
    print('Deleting from favorites Succesful')
if __name__ == '__main__':
    test_adding_channel_to_favorites()

